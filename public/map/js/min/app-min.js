function success(e){console.log("worked")}function initViewModel(){ko.applyBindings(new ViewModel)}function initMap(){function e(e,i){i.marker!=e&&(i.marker=e,i.setContent('<div class="info-box-custom" style="max-width: 300px; text-align: center;"><h5>'+e.name+'</h5><img style="max-width:200px; margin-bottom: 10px;" src="'+e.img+'"><p>'+e.description+"</p></div>"),i.open(map,e),i.addListener("closeclick",function(){i.setMarker=null}))}var i=[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]}],t=new google.maps.InfoWindow,o={url:"/map/img/paw.png",size:new google.maps.Size(34,32),origin:new google.maps.Point(0,0)};map=new google.maps.Map(document.getElementById("map"),{center:{lat:49.288312,lng:-123.0183267},styles:i,zoom:13,mapTypeControl:!1});for(var a=0;a<initialLocations.length;a++){var n=parseFloat(initialLocations[a].lat),s=parseFloat(initialLocations[a].lng);positionObj={lat:n,lng:s};var r=JSON.stringify(positionObj),l=initialLocations[a].name,d="/map/img/uploads/"+initialLocations[a].img_url,m=initialLocations[a].description,c=new google.maps.Marker({position:positionObj,icon:o,name:l,img:d,description:m,animation:google.maps.Animation.DROP,id:a});markers.push(c),c.addListener("click",function(){e(this,t)})}showAllMarkers=function(){for(var e=new google.maps.LatLngBounds,i=0;i<markers.length;i++)markers[i].setMap(map),e.extend(markers[i].position);map.fitBounds(e)},hideAllMarkers=function(){for(var e=0;e<markers.length;e++)markers[e].setMap(null)}}var success=!1;$.getJSON("//catmap.catkittycat.com/api/cats",function(e){success=!0;for(var i in e)initialLocations.push(e[i]);initMap(),initViewModel(),showAllMarkers()}),setTimeout(function(){success||alert("JSON file did not load properly")},5e3),ko.utils.stringStartsWith=function(e,i){return e=e||"",!(i.length>e.length)&&e.substring(0,i.length)===i};var Location=function(e){this.id=ko.observable(e.id),this.name=ko.observable(e.name),this.lat=ko.observable(e.lat),this.lng=ko.observable(e.lng)},ViewModel=function(){var e=this;e.locationList=ko.observableArray([]),initialLocations.forEach(function(i){e.locationList.push(new Location(i))}),e.currentLocation=ko.observable(this.locationList()[0]),e.listClick=function(i){e.currentLocation(i);var t=new google.maps.LatLngBounds,o=ko.toJSON(i.id),a=o.replace(/['"]+/g,"");markers[a].setMap(map),markers[a].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){markers[a].setAnimation(null)},2200),t.extend(markers[a].position),map.fitBounds(t);var n=map.getZoom();map.setZoom(n>15?15:n)},e.showAllClicked=function(){showAllMarkers()},e.hideAllClicked=function(){hideAllMarkers()},e.nameSearch=ko.observable(""),e.filteredRecords=ko.computed(function(){var i=e.nameSearch().toLowerCase();return ko.utils.arrayFilter(e.locationList(),function(e){return-1!==e.name().toLowerCase().indexOf(i)})})},map,showAllMarkers,markers=[],initialLocations=[],positionObj={},sidebarWidth,mapWidthLg="80%",mapWidthMd="70%",mapWidthSm="65%",sidebarWidthLg="20%",sidebarWidthMd="30%",sidebarWidthSm="35%";$("#sidebar-toggle-out").click(function(e){e.preventDefault(),sidebarWidth=$("#sidebar-options").width(),$(".sidebar-options").animate({left:-sidebarWidth},500),$(".map-container").animate({width:"100%",left:"0%"},500,function(){google.maps.event.trigger(map,"resize")}),$("#sidebar-toggle-in").css({display:"block",left:sidebarWidth})}),$("#sidebar-toggle-in").click(function(e){e.preventDefault(),sidebarWidth=$("#sidebar-options").width();var i,t;$(".sidebar-options").animate({left:0},500),sidebarWidth>=sidebarWidthSm?(t=sidebarWidthSm,i=mapWidthSm):sidebarWidth>=sidebarWidthMd&&(t=sidebarWidthMd,i=mapWidthMd),t=sidebarWidthLg,i=mapWidthLg,$(".map-container").animate({width:i,left:t},500,function(){google.maps.event.trigger(map,"resize")}),$("#sidebar-toggle-in").css({display:"none"}),console.log(sidebarWidth)});